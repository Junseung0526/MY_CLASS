📊 대한민국 주요 도시의 2015~2024년 인구 변화 분석
1. 엑셀 파일 불러오기
python
복사
편집
import pandas as pd

# 엑셀 파일 불러오기
file_path = "2015_2024_주민등록인구_연간.xlsx"
df = pd.read_excel(file_path, skiprows=1)  # 첫 번째 행을 건너뛰고 데이터 불러오기
pd.read_excel: 엑셀 파일을 DataFrame 형식으로 불러옵니다.

skiprows=1: 첫 번째 행을 건너뛰고 데이터 불러오기 (제목행 제외).

2. 필요한 열 추출
python
복사
편집
# 특정 열만 추출
df.iloc[2:, [1, 2, 6, 10, 14, 18, 22, 26, 30, 34, 38]]
iloc[]: 지정된 위치에 있는 데이터를 추출.

이 예제에서는 특정 열들을 추출하여 인구수 데이터를 정리합니다.

3. 열 이름 변경 및 정리
python
복사
편집
# 열 이름을 설정 (2015년 ~ 2024년 인구 데이터)
df_total = df.iloc[1:, [1] + total_col_indices].copy()
df_total.columns = ['지역'] + [f'{year}년' for year in range(2015, 2025)]
iloc[]: 데이터의 필요한 행과 열을 선택.

열 이름을 2015년부터 2024년까지의 연도로 변경.

4. 데이터 전처리 (쉼표 제거 및 숫자형 변환)
python
복사
편집
# 쉼표 제거 및 숫자형 변환
for col in df_total.columns[1:]:
    df_total[col] = df_total[col].replace(',', '', regex=True).astype(float)
replace(',', '', regex=True): 쉼표 제거.

astype(float): 숫자 형식으로 변환.

5. 지역명 정리
python
복사
편집
# 지역명 공백 제거
df_total['지역'] = df_total['지역'].str.replace(" ", "")

# 지역명 병합
df_total['지역'] = df_total['지역'].replace({
    '강원특별자치도': '강원도',
    '전북특별자치도': '전라북도'
})
str.replace(): 문자열에서 공백을 제거.

replace(): 특정 값을 다른 값으로 바꿔줌.

6. 중복된 지역명 병합 (최댓값 기준)
python
복사
편집
# 중복된 지역 병합 (최댓값 기준)
df_grouped = df_total.groupby('지역', as_index=False).max()
groupby(): '지역'별로 그룹화 후 최대값을 기준으로 병합.

7. 불필요한 지역명 삭제
python
복사
편집
# 불필요한 지역명 삭제
df_total = df_total.drop(df_total[df_total['지역'].isin(['전국', '강원특별자치도', '전북특별자치도'])].index)
drop(): 특정 지역(전국, 강원특별자치도 등)을 삭제.

8. 데이터를 long 형태로 변환 (melt)
python
복사
편집
# melt 변환 (wide → long)
df_melted = pd.melt(df_grouped, id_vars='지역', var_name='연도', value_name='인구수')
melt(): 데이터를 long 형태로 변환하여 연도별 인구수 데이터를 직관적으로 표현.

9. 연도 열 정리
python
복사
편집
# 연도 열 정리 ('2024년' → 2024)
df_melted['연도'] = df_melted['연도'].str.replace('년', '').astype(int)
str.replace(): 연도에서 "년"을 제거하고 숫자형으로 변환.

10. 인구 변화 시각화
1. 연도별 총 인구 변화
python
복사
편집
import matplotlib.pyplot as plt
import seaborn as sns

# 연도별 총 인구 계산
yearly_total = df_melted.groupby('연도')['인구수'].sum().reset_index()

# 시각화
plt.figure(figsize=(10, 5))
sns.lineplot(data=yearly_total, x='연도', y='인구수', marker='o')
plt.title("연도별 전국 총인구 변화")
plt.ylabel("총 인구수")
plt.xlabel("연도")
plt.grid(True)
plt.tight_layout()
plt.show()
sns.lineplot(): 선 그래프 시각화.

groupby(): 연도별 총 인구수 합계 계산.

2. 지역별 인구 변화 시각화
python
복사
편집
# 관심 지역 선택
selected_regions = ['경상남도', '세종특별자치시']
df_selected = df_melted[df_melted['지역'].isin(selected_regions)]

# 시각화
plt.figure(figsize=(10, 6))
sns.lineplot(data=df_selected, x='연도', y='인구수', hue='지역', marker='o')
plt.title("주요 지역별 인구 변화 추이")
plt.ylabel("인구수")
plt.xlabel("연도")
plt.grid(True)
plt.tight_layout()
plt.show()
hue: 지역별로 색상 구분하여 인구 변화 시각화.

3. 인구 성장률 및 랭킹 분석
python
복사
편집
# 성장률 계산 (2015년 대비 2024년)
pivot_growth = df_growth.pivot(index='지역', columns='연도', values='인구수')
pivot_growth['성장률(%)'] = ((pivot_growth[2024] - pivot_growth[2015]) / pivot_growth[2015]) * 100

# 성장률 순위 정렬
growth_sorted = pivot_growth.sort_values(by='성장률(%)', ascending=False).reset_index()

# 시각화
sns.barplot(data=growth_sorted, y='지역', x='성장률(%)', palette='coolwarm')
pivot(): 데이터 피벗팅.

sort_values(): 성장률 기준으로 지역 순위 정렬.

sns.barplot(): 막대그래프 시각화.

11. 그래프 저장
python
복사
편집
# 1. 연도별 총 인구 변화 그래프 저장
plt.figure(figsize=(8, 4))
sns.lineplot(data=yearly_total, x='연도', y='인구수', marker='o')
plt.title("연도별 전국 총인구 변화")
plt.grid(True)
plt.tight_layout()
plt.savefig("plot_01.png")
plt.close()
plt.savefig(): 그래프를 파일로 저장.

12. HTML 대시보드 생성
python
복사
편집
html_code = f"""
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>인구 데이터 시각화 대시보드</title>
</head>
<body>
    <h1>📊 대한민국 인구 분석 대시보드</h1>

    <h2>1. 연도별 전국 총인구 변화</h2>
    <img src="plot_01.png" width="800">

    <h2>2. 주요 지역 인구 변화 추이</h2>
    <img src="plot_02.png" width="800">

    <h2>3. 지역별 인구 성장률 (2015~2024)</h2>
    <img src="plot_03.png" width="800">

    <p style="font-size:12px;">※ 데이터 출처: 주민등록 인구통계 엑셀 기준</p>
</body>
</html>
"""

# 저장
with open("인구_시각화_대시보드.html", "w", encoding="utf-8") as f:
    f.write(html_code)

print("✅ 저장 완료: 인구_시각화_대시보드.html")
html_code: HTML로 시각화 대시보드를 만들고 이미지 삽입.

open(): HTML 파일로 저장.

위와 같은 흐름으로 데이터를 정리하고 시각화 및 HTML 대시보드를 생성할 수 있습니다.
