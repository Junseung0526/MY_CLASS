# 5. 마이크로컨트롤러

날짜: 2025년 3월 26일
학습 상태: 완료
복습 필요: Yes

### **🔹 마이크로컨트롤러 보드**

- **마이크로컨트롤러 보드** = **마이크로컨트롤러** + **추가 기능(A)**
- **하나의 칩에 컴퓨터 기능을 포함**하여, 전원만 공급하면 독립적으로 동작 가능
- **입출력 장치를 연결하여 컴퓨터처럼 활용 가능**

🖥️ **구성 요소**:

- **연산 장치 (ALU) ↔ 제어 장치 (CU) ↔ 주기억 장치 (RAM, ROM)**
- **CPU + 메모리 + HDD 기능 + 입출력 인터페이스 포함**

---

### **🔹 마이크로프로세서(Microprocessor, uP)**

- **컴퓨터의 중앙 처리 장치(CPU)를 하나의 칩으로 구현한 반도체 소자**
- **운영체제를 실행하여 다양한 프로그램 실행 가능**

---

### **🔹 마이크로컨트롤러(Microcontroller, uC)**

- **메인보드 + 일부 저장 장치(HDD) 기능 포함**
- **작고 가벼운(마이크로) 제어 장치(컨트롤러)**
- **내장 메모리 및 I/O 인터페이스가 있어 추가적인 장치 없이 독립적으로 동작**

📌 **주로 임베디드 시스템, IoT, 가전제품 등에 사용**

---

### **🔹 마이크로프로세서(uP) vs 마이크로컨트롤러(uC) 차이점** 🔄

| 항목 | 마이크로프로세서 (uP) | 마이크로컨트롤러 (uC) |
| --- | --- | --- |
| **메모리** | 외부 RAM/ROM 필요 | 내부 RAM/ROM 포함 |
| **주변 장치** | 필요에 따라 추가 | 내장 I/O, ADC, 타이머 포함 |
| **컴퓨팅 용량** | 고성능 | 비교적 저성능 |
| **클록 속도** | 1GHz 이상 | 수 MHz ~ 수백 MHz |
| **전력 소비량** | 상대적으로 높음 | 저전력 설계 |
| **운영체제** | OS 필요 (Windows, Linux 등) | OS 없이 독립 실행 가능 |
| **연결성** | 다양한 입출력 장치 필요 | 자체 입출력 인터페이스 포함 |
| **비용** | 상대적으로 비쌈 | 저렴한 가격 |
| **사용 사례** | PC, 서버, 고급 임베디드 시스템 | IoT, 로봇, 가전제품, 임베디드 시스템 |

---

### **🔹 마이크로프로세서 vs 마이크로컨트롤러 시스템 비교** 🆚

| 항목 | 아두이노 메가 2560 (Microcontroller) | 데스크톱 컴퓨터 (Microprocessor) |
| --- | --- | --- |
| **CPU** | ATmega2560 | Intel, AMD CPU |
| **비트** | 8-bit | 64-bit |
| **메모리** | 256KB 플래시, 8KB SRAM | GB 단위 RAM, TB 단위 HDD/SSD |
| **클록 속도** | 16MHz | 2~5GHz |
| **시스템 가격** | 수천 원~수만 원 | 수십만 원~수백만 원 |

---

### **🔹 마이크로컨트롤러 사용 예** 🏥🚗🏠

| **분야** | **사용 예** |
| --- | --- |
| **의료** | 심장 박동기, 혈압 측정기, 체온 측정기, 인슐린 펌프 |
| **교통** | 신호등 제어 시스템, GPS 내비게이션, 자동 통행료 징수 시스템 |
| **감시** | CCTV 카메라, 출입 보안 시스템, 스마트 도어락 |
| **가전** | 스마트 냉장고, 전자레인지, 세탁기, 스마트 TV |
| **음향** | 디지털 오디오 플레이어, 스피커 시스템, 노이즈 캔슬링 헤드폰 |
| **사무** | 프린터, 복사기, 키보드 & 마우스 컨트롤러 |
| **자동차** | ABS 브레이크 시스템, 자동차 센서, 자동 주차 시스템 |
| **기타** | 로봇, 드론, 스마트 농업, 웨어러블 기기 (스마트워치) |

---

### **🔹 마이크로컨트롤러 사용의 장단점**

### **📌 단점 ❌**

- 점등 회로 같은 단순한 하드웨어 구현에 비해 별다른 장점 없음
- 마이크로컨트롤러 기능을 100% 사용하지 않는 경우 많음
- 별도의 **소프트웨어 개발 필요** (펌웨어, 프로그래밍 필요)

### **📌 장점 ✅**

- 기능 추가/변경이 쉬움 → **소프트웨어만 수정하면 가능**
- 지속적인 가격 하락  → 소형화 & 경량화 가능
- **초기 개발 시간 단축** , 유지보수 비용 절감
- 유연한 설계 가능 → 하나의 칩으로 여러 기능 통합 가능

---

### **🔹 교차 개발 환경 (Cross Development Environment)**

📌 **개발 시스템 (Development System)** 

✅ 프로그램 개발 & 작성 → **데스크톱 컴퓨터 사용**

✅ 소프트웨어 작성 후 **교차 컴파일러** 사용 (PC → 마이크로컨트롤러 변환)

📌 **목적 시스템 (Target System)** 🎛️

✅ 개발된 기계어 파일(바이너리 코드) → **전용 장치(업로더)로 업로드**

✅ 실행 환경 = **마이크로컨트롤러 보드 (ex. 아두이노, ESP32 등)**

---

### **🔹 아두이노 프로그램 구조**

📌 **C++ 기반** 

✅ 일반적으로 C++의 **main() 함수** 필요

✅ 하지만 **아두이노에서는 main()이 자동으로 처리됨**

✅ **setup()과 loop()** 함수를 이용하여 간단하게 작성 가능

📌 **실제 메인 코드 위치**

✅ **아두이노 프로그램이 설치된 디렉토리** 내 **main.cpp** 파일에 정의됨

---

### **🔹 플로팅 현상 (Floating Phenomenon)**

✔ **'유동적인' 상태**를 의미하며, **전압이 애매하게 떠 있는 현상**

✔ 마이크로컨트롤러의 **디지털 입력 핀**이 **어느 상태인지 불명확**해짐

✔ 주변 전기장 변화에 따라 입력값이 변동 → **예측할 수 없는 동작 발생**

✔ 해결책: **풀업 저항 (Pull-up Resistor)** 또는 **풀다운 저항 (Pull-down Resistor) 사용**

---

### **🔹 풀업 저항 (Pull-up Resistor)**

✔ 기본 상태: **HIGH (5V)**

✔ 버튼을 누르면 LOW(0V)로 전환됨

✔ 마이크로컨트롤러 내부에 **내장 풀업 저항**이 있음 (`INPUT_PULLUP` 사용 가능)

✔ 일반적으로 **10KΩ 저항 사용**

---

### **🔹 풀다운 저항 (Pull-down Resistor)**

✔ 기본 상태: **LOW (0V)**

✔ 버튼을 누르면 HIGH(5V)로 전환됨

✔ 마이크로컨트롤러는 **풀다운 저항을 내장하고 있지 않음** → **외부 저항 필요**

✔ 일반적으로 **10KΩ 저항 사용**

![image.png](5%20%E1%84%86%E1%85%A1%E1%84%8B%E1%85%B5%E1%84%8F%E1%85%B3%E1%84%85%E1%85%A9%E1%84%8F%E1%85%A5%E1%86%AB%E1%84%90%E1%85%B3%E1%84%85%E1%85%A9%E1%86%AF%E1%84%85%E1%85%A5%201bbc51a948fd80628a99e4bd84281d24/image.png)

---

🔊 **📢 피에조 부저 (Piezo Buzzer) 관련 명령어**

- `tone(pin, frequency);` → **지정한 핀에서 주파수(Hz) 음 발생**
- `noTone(pin);` → **부저 소리 끄기**

📟 **🎚️ 가변저항 (Potentiometer) 관련 명령어**

- `analogRead(pin);` → **가변저항 값을 읽어옴 (0~1023 범위의 아날로그 값)**

---

### **📌 가변저항 (Potentiometer) 개요**

🔹 **가변저항이란?**

- 사용자가 **직접 저항값을 변경**할 수 있는 저항기
- 소리 크기 조절 장치(볼륨), 조명 밝기 조절 등에 사용됨
- 영어로 **Potentiometer**라고 하며, 줄여서 **"포텐쇼미터"**라고도 함

---

### **🎛️ 가변저항의 원리**

💡 **단자 구조:**

- **1번 (VCC/전원)**
- **2번 (출력/스위퍼)**
- **3번 (GND/접지)**

🔄 **작동 원리:**

- 스위퍼(가변 조절 부분)가 이동하면 **2번 단자의 출력 전압이 변함**
- **전압 분배 원리**를 이용하여 입력 전압을 비율에 따라 조절할 수 있음

📏 **수식 (전압 분배 공식):**

$$
V_{out} = V_{in} \times \frac{R_2}{R_1 + R_2}
$$

$$
V_{out} : 2번 단자의 출력 전압
$$

$$
V_{in} : 입력 전압 (1번 단자)
$$

$$
R1,R2 : 가변저항 내부의 저항값
$$

---

### **⚡ 가변저항의 사용 예시**

🔊 **볼륨 조절** - 오디오 장치에서 소리 크기 조절

💡 **조명 밝기 조절** - LED 밝기 조절

🔋 **모터 속도 제어** - 전압 조절을 통한 속도 변화

📟 **센서 보정** - 전자회로에서 미세한 조절이 필요할 때

![image.png](5%20%E1%84%86%E1%85%A1%E1%84%8B%E1%85%B5%E1%84%8F%E1%85%B3%E1%84%85%E1%85%A9%E1%84%8F%E1%85%A5%E1%86%AB%E1%84%90%E1%85%B3%E1%84%85%E1%85%A9%E1%86%AF%E1%84%85%E1%85%A5%201bbc51a948fd80628a99e4bd84281d24/image%201.png)

---

### **🔢 `map()` 함수란?**

📌 **센서 값을 원하는 범위로 변환할 때 사용**

![image.png](5%20%E1%84%86%E1%85%A1%E1%84%8B%E1%85%B5%E1%84%8F%E1%85%B3%E1%84%85%E1%85%A9%E1%84%8F%E1%85%A5%E1%86%AB%E1%84%90%E1%85%B3%E1%84%85%E1%85%A9%E1%86%AF%E1%84%85%E1%85%A5%201bbc51a948fd80628a99e4bd84281d24/image%202.png)

### **🛠️ `map()` 함수 기본 형식**

```cpp
cpp
복사편집
map(value, fromLow, fromHigh, toLow, toHigh)

```

- `value` → 변환할 값
- `fromLow`, `fromHigh` → 현재 값의 범위
- `toLow`, `toHigh` → 변환할 목표 범위

### **📝 예제: 가변저항 → PWM 값 변환**

```cpp
int sensorValue = analogRead(A0);  // 0~1023 값 읽기
int pwmValue = map(sensorValue, 0, 1023, 0, 255);  // 0~255 범위로 변환
analogWrite(9, pwmValue);  // LED 밝기 조절
```

🔹 **사용 예시:**

- 가변저항 값(0~~1023)을 LED 밝기 값(0~~255)으로 변환
- 초음파 센서 거리값을 서보모터 각도(0~180)로 변환

🚀 **한 줄 요약:**

📍 **`map()`은 센서 값을 내가 원하는 범위로 변환해주는 함수!** 🎯