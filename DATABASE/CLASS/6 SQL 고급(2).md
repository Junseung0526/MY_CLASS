# 6.  SQL 고급(2)

날짜: 2025년 4월 9일
학습 상태: 완료
중요도: 상
복습 필요: No

### 📌 1. 뷰(View)

- **정의**: 하나 이상의 테이블을 조합한 **가상의 테이블**
- **특징**
    - 실제 데이터를 저장하지 않음
    - 원본 테이블이 변경되면 뷰도 함께 반영
    - 삽입/삭제/수정 연산에 제약이 많음
- **장점**
    - **편리성**: 복잡한 질의를 간단히 재사용 가능
    - **보안성**: 민감한 정보를 숨기고 필요한 정보만 보여줌
    - **논리적 독립성**: 테이블 구조 변경에도 뷰를 통해 영향 최소화
- **관련 SQL**
    
    ```sql
    CREATE VIEW 뷰이름 AS SELECT ...
    CREATE OR REPLACE VIEW ...
    DROP VIEW 뷰이름;
    
    -- 수정 가능 여부 확인
    SELECT column_name, updatable, insertable, deletable
    FROM USER_UPDATABLE_COLUMNS
    WHERE TABLE_NAME = '뷰이름';
    ```
    

---

### 📌 2. 인덱스(Index)

- **정의**: 데이터 검색 성능을 향상시키는 자료 구조
- **기본 구조**: 대부분 **B-tree**
- **사용 시기**
    - WHERE, JOIN 조건에서 자주 사용하는 컬럼
    - 중복 값이 적고 선택도가 높은 컬럼
- **종류**
    - **B-tree**: 가장 일반적인 인덱스 구조
    - **Bitmap**: 값이 적은 컬럼 (예: 성별 등)
    - **IOT**: 인덱스 조직 테이블
    - **FBI**: 함수 기반 인덱스
- **관련 SQL**
    
    ```sql
    CREATE INDEX idx_name ON 테이블명(컬럼명);
    ALTER INDEX idx_name REBUILD;
    DROP INDEX idx_name;
    ```
    

---

### 📌 3. 저장 구조

- **저장 계층**
    
    > 테이블스페이스 > 세그먼트 > 익스텐트 > 블록
    > 
- **블록**: DB에서 데이터를 저장하는 최소 단위 (예: 8KB)
- **디스크 접근 시간 구성**
    - Seek Time: 헤더가 위치로 이동하는 시간
    - Rotational Delay: 섹터가 헤드 아래로 오는 시간
    - Transfer Time: 데이터를 메모리로 전송하는 시간

---

### 📌 4. 부속질의 (서브쿼리)

- **중첩 질의**: `WHERE` 절에 사용됨
    
    예: 특정 조건을 만족하는 행만 추출할 때
    
- **인라인 뷰**: `FROM` 절 안의 서브쿼리
    
    예: 서브쿼리 결과를 마치 테이블처럼 사용
    
- **스칼라 서브쿼리**: `SELECT` 절에 사용되며, 단일 값 반환
    
    예: "고객의 평균 구매액" 같은 값을 SELECT 절에서 계산할 때